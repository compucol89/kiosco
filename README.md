# üè™ Tayrona Almac√©n - Sistema POS Kiosco

Sistema de Punto de Venta completo y optimizado para kioscos, almacenes y minimarkets en Argentina.

---

## üìã √çndice

- [Descripci√≥n](#-descripci√≥n)
- [Caracter√≠sticas Principales](#-caracter√≠sticas-principales)
- [Stack Tecnol√≥gico](#%EF%B8%8F-stack-tecnol√≥gico)
- [Arquitectura del Sistema](#-arquitectura-del-sistema)
- [M√≥dulos del Sistema](#-m√≥dulos-del-sistema)
- [Requisitos Previos](#-requisitos-previos)
- [Instalaci√≥n](#-instalaci√≥n)
- [Configuraci√≥n](#%EF%B8%8F-configuraci√≥n)
- [Estructura del Proyecto](#-estructura-del-proyecto)
- [Base de Datos](#%EF%B8%8F-base-de-datos)
- [API Endpoints](#-api-endpoints)
- [Integraci√≥n AFIP](#-integraci√≥n-afip)
- [Seguridad](#-seguridad)
- [Sistema de Permisos](#-sistema-de-permisos)
- [Flujo de Trabajo](#-flujo-de-trabajo)
- [Componentes Principales](#-componentes-principales)
- [Hooks Personalizados](#-hooks-personalizados)
- [Servicios](#-servicios)
- [Uso del Sistema](#-uso-del-sistema)
- [Mantenimiento](#%EF%B8%8F-mantenimiento)
- [Troubleshooting](#-troubleshooting)
- [Licencia](#-licencia)

---

## üéØ Descripci√≥n

**Tayrona Almac√©n** es un sistema POS (Point of Sale) completo desarrollado espec√≠ficamente para negocios minoristas en Argentina como kioscos, almacenes y minimarkets.

El sistema est√° dise√±ado con una arquitectura moderna, separando claramente el frontend (React) del backend (PHP), permitiendo escalabilidad, mantenibilidad y un rendimiento √≥ptimo.

### Dise√±ado para Argentina

- ‚úÖ Facturaci√≥n electr√≥nica AFIP integrada
- ‚úÖ Formato de moneda argentino (ARS)
- ‚úÖ Comprobantes fiscales (Factura A, B, C)
- ‚úÖ Gesti√≥n de CUIT y datos fiscales
- ‚úÖ Normativa contable argentina

---

## ‚ú® Caracter√≠sticas Principales

### üí∞ Control de Caja Profesional
- Apertura y cierre de caja con validaci√≥n de efectivo
- Registro detallado de movimientos (ingresos/egresos)
- Historial completo de turnos de caja
- Reportes de diferencias por cajero
- Sincronizaci√≥n autom√°tica con ventas
- Validaci√≥n obligatoria de caja abierta para operar

### üõí Punto de Venta (POS)
- Interfaz r√°pida y optimizada para ventas
- B√∫squeda inteligente de productos con autocompletado
- Control de stock en tiempo real con alertas
- M√∫ltiples m√©todos de pago (efectivo, tarjeta, transferencia)
- Descuentos autom√°ticos por m√©todo de pago
- Generaci√≥n de tickets profesionales
- Shortcuts de teclado (F6-F8, Enter, Escape)
- Facturaci√≥n AFIP opcional integrada

### üì¶ Gesti√≥n de Inventario
- CRUD completo de productos
- Gesti√≥n de categor√≠as y proveedores
- Control de stock con alertas autom√°ticas
- Auditor√≠a de movimientos de inventario
- Importaci√≥n masiva de productos
- An√°lisis de ventas por producto
- B√∫squeda enterprise-grade (<25ms)
- Sistema de im√°genes con cach√© optimizado

### üìä Reportes y Analytics
- Dashboard completo con m√©tricas en tiempo real
- Reportes de ventas detallados por per√≠odo
- An√°lisis financiero con P&L
- Reportes de efectivo por per√≠odo
- Estad√≠sticas de productos m√°s vendidos
- An√°lisis de rentabilidad por producto
- Exportaci√≥n a Excel (XLSX)

### ü§ñ Inteligencia Artificial
- An√°lisis inteligente de ventas con OpenAI
- Diagn√≥stico financiero automatizado
- Predicciones de inventario
- Detecci√≥n de patrones de venta
- Recomendaciones de stock
- Sistema anti-fraude

### üë• Gesti√≥n de Usuarios
- Sistema de autenticaci√≥n seguro
- 3 roles de usuario: Admin, Vendedor, Cajero
- Permisos granulares por m√≥dulo
- Gesti√≥n completa de usuarios
- Auditor√≠a de acciones

### üßæ Facturaci√≥n AFIP
- Integraci√≥n completa con Web Services AFIP
- Generaci√≥n autom√°tica de comprobantes fiscales
- Soporte para Factura A, B y C
- Sistema h√≠brido (real + fallback simulado)
- Cach√© inteligente de tokens de acceso
- Procesamiento as√≠ncrono opcional
- Logs detallados de operaciones AFIP

---

## üõ†Ô∏è Stack Tecnol√≥gico Completo

### üé® Frontend (React SPA)

#### Core Framework
| Tecnolog√≠a | Versi√≥n | Prop√≥sito | Notas |
|------------|---------|-----------|-------|
| **React** | 18.2.0 | Framework principal de UI | Virtual DOM, Hooks, Componentes funcionales |
| **React DOM** | 18.2.0 | Renderizado en navegador | Integraci√≥n con el DOM |
| **React Router DOM** | 7.5.1 | Navegaci√≥n SPA | Enrutamiento client-side |
| **React Scripts** | 5.0.1 | Build tools (Webpack, Babel) | Create React App |

#### Estilos y UI
| Tecnolog√≠a | Versi√≥n | Prop√≥sito | Notas |
|------------|---------|-----------|-------|
| **Tailwind CSS** | 3.3.3 | Framework CSS utility-first | Mobile-first, responsive |
| **PostCSS** | 8.4.31 | Procesador CSS | Transformaciones CSS |
| **Autoprefixer** | 10.4.16 | Prefijos CSS autom√°ticos | Compatibilidad multi-browser |
| **Lucide React** | 0.501.0 | Sistema de iconos modernos | 1000+ iconos SVG optimizados |
| **React Icons** | 5.5.0 | Biblioteca adicional de iconos | Font Awesome, Material, etc. |
| **React Feather** | 2.0.10 | Iconos Feather | Iconos minimalistas |

#### Gr√°ficos y Visualizaci√≥n
| Tecnolog√≠a | Versi√≥n | Prop√≥sito | Notas |
|------------|---------|-----------|-------|
| **Chart.js** | 4.4.9 | Motor de gr√°ficos | Canvas-based, responsivo |
| **React Chart.js 2** | 5.3.0 | Wrapper React para Chart.js | Componentes React |
| **ChartJS Plugin Datalabels** | 2.2.0 | Labels en gr√°ficos | Anotaciones y etiquetas |

#### HTTP y Comunicaci√≥n
| Tecnolog√≠a | Versi√≥n | Prop√≥sito | Notas |
|------------|---------|-----------|-------|
| **Axios** | 1.8.4 | Cliente HTTP | Promesas, interceptores |
| **Node Fetch** | 3.3.2 | Fetch API para Node | Polyfill para SSR |

#### Documentos y Exportaci√≥n
| Tecnolog√≠a | Versi√≥n | Prop√≥sito | Notas |
|------------|---------|-----------|-------|
| **jsPDF** | 3.0.1 | Generaci√≥n de PDFs | Tickets, reportes |
| **jsPDF AutoTable** | 5.0.2 | Tablas en PDFs | Reportes tabulares |
| **XLSX** | 0.18.5 | Exportaci√≥n a Excel | SheetJS - lectura/escritura |

#### Utilidades y Componentes
| Tecnolog√≠a | Versi√≥n | Prop√≥sito | Notas |
|------------|---------|-----------|-------|
| **React Toastify** | 11.0.5 | Notificaciones toast | Mensajes emergentes |
| **React Webcam** | 7.2.0 | Acceso a c√°mara | Captura de evidencias |
| **JSBarcode** | 3.12.1 | Generaci√≥n de c√≥digos de barras | Tickets y productos |

#### Build y Desarrollo
| Tecnolog√≠a | Versi√≥n | Prop√≥sito | Notas |
|------------|---------|-----------|-------|
| **Cross-env** | 7.0.3 | Variables de entorno cross-platform | Windows/Linux/Mac |
| **Prettier** | 3.6.2 | Formateador de c√≥digo | Code style consistente |
| **Rimraf** | 5.0.10 | Limpieza de archivos | Cross-platform rm -rf |
| **Serve** | 14.2.4 | Servidor est√°tico | Servir build en producci√≥n |

**Total de dependencias frontend:** 28 paquetes NPM

---

### ‚öôÔ∏è Backend (PHP API)

#### Core
| Tecnolog√≠a | Versi√≥n | Prop√≥sito | Notas |
|------------|---------|-----------|-------|
| **PHP** | 8.0+ | Lenguaje servidor | OOP, tipado fuerte |
| **PDO** | Incluido en PHP | Abstracci√≥n de base de datos | Prepared statements, seguridad |
| **Composer** | 2.0+ | Gestor de dependencias PHP | Autoloading PSR-4 |

#### Extensiones PHP Requeridas
```bash
php-pdo          # PHP Data Objects
php-pdo_mysql    # Driver MySQL para PDO
php-mysqli       # MySQL Improved (legacy)
php-json         # Manejo de JSON
php-mbstring     # Strings multibyte
php-curl         # Cliente HTTP
php-xml          # Procesamiento XML (AFIP)
php-openssl      # Encriptaci√≥n SSL/TLS
php-zip          # Compresi√≥n (opcional)
php-gd           # Procesamiento de im√°genes
```

#### Bibliotecas PHP
| Biblioteca | Versi√≥n | Prop√≥sito | Notas |
|------------|---------|-----------|-------|
| **AFIP SDK** | 1.2 | Integraci√≥n con AFIP | Facturaci√≥n electr√≥nica |

**Total de dependencias backend:** 1 paquete (Composer)

---

### üóÑÔ∏è Base de Datos

#### Motor de Base de Datos
| Tecnolog√≠a | Versi√≥n | Prop√≥sito | Caracter√≠sticas |
|------------|---------|-----------|-----------------|
| **MySQL** | 8.0+ | Base de datos relacional | ACID, transacciones, √≠ndices |
| **MariaDB** | 10.6+ | Alternativa compatible | Fork de MySQL |

#### Especificaciones
- **Charset:** UTF-8MB4 (soporte Unicode completo, emojis)
- **Collation:** utf8mb4_unicode_ci
- **Motor:** InnoDB (transaccional, foreign keys)
- **Zona horaria:** America/Argentina/Buenos_Aires (UTC-3)

#### Conexi√≥n PDO
```php
// Configuraci√≥n PDO
[
    PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,        // Excepciones en errores
    PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,   // Arrays asociativos
    PDO::MYSQL_ATTR_INIT_COMMAND => 'SET NAMES utf8mb4', // Charset UTF8MB4
    PDO::ATTR_EMULATE_PREPARES => false,                 // Prepared statements nativos
    PDO::ATTR_TIMEOUT => 30                              // Timeout 30 segundos
]
```

---

### üñ•Ô∏è Infraestructura y Servidor

#### Entorno de Desarrollo (Windows)
| Componente | Tecnolog√≠a | Versi√≥n | Descripci√≥n |
|------------|------------|---------|-------------|
| **Stack Local** | Laragon | Latest | Apache + PHP + MySQL todo-en-uno |
| **Servidor Web** | Apache | 2.4+ | mod_rewrite habilitado |
| **PHP** | PHP | 8.0+ | Con extensiones requeridas |
| **Base de Datos** | MySQL | 8.0+ | Puerto 3306 |
| **Node.js** | Node.js | 18.0+ | Runtime JavaScript |
| **NPM** | NPM | 8.0+ | Gestor de paquetes |
| **Git** | Git Bash | Latest | Control de versiones |

#### Entorno de Producci√≥n (Linux)
| Componente | Tecnolog√≠a | Versi√≥n | Descripci√≥n |
|------------|------------|---------|-------------|
| **Servidor Web** | NGINX / Apache | 1.18+ / 2.4+ | Servidor HTTP |
| **PHP-FPM** | PHP-FPM | 8.0+ | FastCGI Process Manager |
| **Base de Datos** | MySQL | 8.0+ | Servidor MySQL |
| **SSL/TLS** | Let's Encrypt | - | Certificados HTTPS gratuitos |

#### Requisitos del Sistema

**Desarrollo (Local):**
```
Sistema Operativo: Windows 10/11
RAM: 4GB m√≠nimo, 8GB recomendado
Disco: 2GB espacio libre
Navegador: Chrome/Firefox/Edge (√∫ltimas versiones)
```

**Producci√≥n (Servidor):**
```
Sistema Operativo: Linux (Ubuntu 20.04+, CentOS 7+)
RAM: 2GB m√≠nimo, 4GB recomendado
Disco: 10GB espacio libre
CPU: 1 core m√≠nimo, 2 cores recomendado
Ancho de banda: 100 Mbps
```

---

### üîå Conexi√≥n a Base de Datos

El sistema utiliza una **arquitectura de conexi√≥n centralizada** con el patr√≥n Singleton.

#### Archivos de Configuraci√≥n

##### 1. `api/db_config.php` - Credenciales (√öNICO ARCHIVO)
```php
<?php
/**
 * ARCHIVO √öNICO DE CONFIGURACI√ìN DE BASE DE DATOS
 * Modificar solo este archivo para cambiar credenciales
 */

// üè† CONFIGURACI√ìN LOCAL (LARAGON)
define('DB_HOST', 'localhost');
define('DB_PORT', '3306');
define('DB_NAME', 'kiosco_db');
define('DB_USER', 'root');
define('DB_PASS', '');
define('DB_CHARSET', 'utf8mb4');

// ‚öôÔ∏è OPCIONES DE CONEXI√ìN PDO
$GLOBALS['DB_OPTIONS'] = [
    PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
    PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,
    PDO::MYSQL_ATTR_INIT_COMMAND => 'SET NAMES utf8mb4',
    PDO::ATTR_EMULATE_PREPARES => false,
    PDO::ATTR_TIMEOUT => 30
];

// üåç CONFIGURACI√ìN ADICIONAL
define('DB_TIMEZONE', 'America/Argentina/Buenos_Aires');
define('DB_PERSISTENT', false);
?>
```

##### 2. `api/bd_conexion.php` - Clase de Conexi√≥n
```php
<?php
/**
 * Conexi√≥n √∫nica a base de datos MySQL
 * Patr√≥n Singleton para reutilizar conexi√≥n
 */

require_once __DIR__ . '/db_config.php';

class Conexion {
    private static $conexion = null;
    
    /**
     * Obtiene conexi√≥n PDO a la base de datos
     * Singleton: reutiliza la misma conexi√≥n
     */
    public static function obtenerConexion() {
        try {
            // Si ya existe conexi√≥n, reutilizarla
            if (self::$conexion !== null) {
                return self::$conexion;
            }
            
            // Crear DSN (Data Source Name)
            $dsn = sprintf(
                'mysql:host=%s;port=%s;dbname=%s;charset=%s',
                DB_HOST,
                DB_PORT,
                DB_NAME,
                DB_CHARSET
            );
            
            // Crear conexi√≥n PDO
            self::$conexion = new PDO(
                $dsn, 
                DB_USER, 
                DB_PASS, 
                $GLOBALS['DB_OPTIONS']
            );
            
            // Configurar zona horaria Argentina (UTC-3)
            self::$conexion->exec("SET time_zone = '-03:00'");
            
            return self::$conexion;
            
        } catch (PDOException $e) {
            error_log("[BD_CONEXION] ‚ùå Error: " . $e->getMessage());
            throw $e;
        }
    }
    
    /**
     * Cierra la conexi√≥n
     */
    public static function cerrarConexion() {
        self::$conexion = null;
    }
}
?>
```

#### Flujo de Conexi√≥n

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Endpoint API (ej: productos.php)              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ require_once 'bd_conexion.php'
                  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  bd_conexion.php                                ‚îÇ
‚îÇ  - Carga db_config.php                          ‚îÇ
‚îÇ  - Clase Conexion (Singleton)                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ require_once 'db_config.php'
                  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  db_config.php                                  ‚îÇ
‚îÇ  - DB_HOST, DB_NAME, DB_USER, DB_PASS          ‚îÇ
‚îÇ  - DB_OPTIONS (PDO configuration)               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ Constantes definidas
                  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Conexion::obtenerConexion()                    ‚îÇ
‚îÇ  1. Verifica si existe conexi√≥n (Singleton)     ‚îÇ
‚îÇ  2. Si no existe, crea nueva con PDO            ‚îÇ
‚îÇ  3. Configura timezone Argentina                ‚îÇ
‚îÇ  4. Retorna objeto PDO                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ Objeto PDO listo
                  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Endpoint ejecuta queries con PDO               ‚îÇ
‚îÇ  $pdo = Conexion::obtenerConexion();           ‚îÇ
‚îÇ  $stmt = $pdo->prepare("SELECT * FROM ...");   ‚îÇ
‚îÇ  $stmt->execute();                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### Uso en Endpoints API

Todos los ~110 endpoints PHP usan el mismo patr√≥n:

```php
<?php
// Ejemplo: api/productos.php

// Incluir conexi√≥n
require_once 'bd_conexion.php';

// Obtener conexi√≥n PDO (Singleton)
$pdo = Conexion::obtenerConexion();

// Ejecutar query con prepared statement
$stmt = $pdo->prepare("
    SELECT * FROM productos 
    WHERE activo = 1 
    ORDER BY nombre ASC
");
$stmt->execute();

// Obtener resultados
$productos = $stmt->fetchAll(PDO::FETCH_ASSOC);

// Retornar JSON
header('Content-Type: application/json');
echo json_encode([
    'success' => true,
    'data' => $productos
]);
?>
```

#### Ventajas de esta Arquitectura

‚úÖ **Un solo archivo de credenciales** - F√°cil de cambiar en producci√≥n  
‚úÖ **Patr√≥n Singleton** - Reutiliza la misma conexi√≥n PDO  
‚úÖ **Prepared Statements** - Protecci√≥n contra SQL Injection  
‚úÖ **Manejo de excepciones** - Errores bien manejados  
‚úÖ **Centralizado** - Todos los endpoints usan la misma clase  
‚úÖ **Configuraci√≥n por ambiente** - Local, Hostinger, Railway, etc.  

#### Configuraci√≥n para Producci√≥n

Para cambiar de ambiente **local ‚Üí producci√≥n**, solo editar `api/db_config.php`:

```php
// ========================================================================
// üìå PARA HOSTINGER
// ========================================================================
define('DB_HOST', 'localhost');
define('DB_PORT', '3306');
define('DB_NAME', 'u123456789_kiosco');     // ‚ö†Ô∏è CAMBIAR
define('DB_USER', 'u123456789_admin');      // ‚ö†Ô∏è CAMBIAR
define('DB_PASS', 'TU_PASSWORD_SEGURO');    // ‚ö†Ô∏è CAMBIAR
define('DB_CHARSET', 'utf8mb4');
```

**Un solo cambio, todo el sistema se actualiza autom√°ticamente.**

---

### üìä Comunicaci√≥n Frontend ‚Üî Backend

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    FRONTEND (React)                          ‚îÇ
‚îÇ  http://localhost:3000                                       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                               ‚îÇ
‚îÇ  src/config/config.js                                        ‚îÇ
‚îÇ  ‚îú‚îÄ API_URL: 'http://localhost/kiosco'                      ‚îÇ
‚îÇ  ‚îî‚îÄ API_ENDPOINTS: { ... }                                   ‚îÇ
‚îÇ                                                               ‚îÇ
‚îÇ  src/services/api.js                                         ‚îÇ
‚îÇ  ‚îî‚îÄ Axios HTTP Client                                        ‚îÇ
‚îÇ                                                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
                  ‚îÇ HTTP Request (GET/POST/PUT/DELETE)
                  ‚îÇ JSON Payload
                  ‚îÇ
                  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    BACKEND (PHP API)                         ‚îÇ
‚îÇ  http://localhost/kiosco/api/                                ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                               ‚îÇ
‚îÇ  index.php (Entry Point)                                     ‚îÇ
‚îÇ  ‚îî‚îÄ Enruta /api/* a archivos PHP correspondientes            ‚îÇ
‚îÇ                                                               ‚îÇ
‚îÇ  api/productos.php, api/ventas_reales.php, etc.             ‚îÇ
‚îÇ  ‚îú‚îÄ require_once 'bd_conexion.php'                          ‚îÇ
‚îÇ  ‚îú‚îÄ $pdo = Conexion::obtenerConexion()                      ‚îÇ
‚îÇ  ‚îú‚îÄ Ejecuta queries SQL                                      ‚îÇ
‚îÇ  ‚îî‚îÄ Retorna JSON                                             ‚îÇ
‚îÇ                                                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ
                  ‚îÇ PDO Connection
                  ‚îÇ Prepared Statements
                  ‚îÇ
                  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                  BASE DE DATOS (MySQL)                        ‚îÇ
‚îÇ  localhost:3306                                              ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                               ‚îÇ
‚îÇ  kiosco_db                                                   ‚îÇ
‚îÇ  ‚îú‚îÄ productos                                                ‚îÇ
‚îÇ  ‚îú‚îÄ ventas                                                   ‚îÇ
‚îÇ  ‚îú‚îÄ turnos_caja                                              ‚îÇ
‚îÇ  ‚îú‚îÄ usuarios                                                 ‚îÇ
‚îÇ  ‚îî‚îÄ ... (~15 tablas)                                         ‚îÇ
‚îÇ                                                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### Ejemplo de Flujo Completo

1. **Frontend** hace petici√≥n:
```javascript
// src/services/api.js
const response = await axios.get(
    'http://localhost/kiosco/api/productos.php'
);
```

2. **Backend** procesa:
```php
// api/productos.php
$pdo = Conexion::obtenerConexion();
$stmt = $pdo->prepare("SELECT * FROM productos");
$stmt->execute();
$productos = $stmt->fetchAll();
echo json_encode(['success' => true, 'data' => $productos]);
```

3. **Frontend** recibe:
```javascript
console.log(response.data.productos);
// Array de productos
```

---

### üöÄ Versiones del Proyecto

| Componente | Versi√≥n Actual |
|------------|----------------|
| **Proyecto** | v1.0.1 |
| **Frontend** | React 18.2.0 |
| **Backend** | PHP 8.0+ |
| **Base de Datos** | MySQL 8.0+ |

---

## üèó Arquitectura del Sistema

### Arquitectura Three-Tier

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    CAPA DE PRESENTACI√ìN                      ‚îÇ
‚îÇ                        (Frontend)                            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  React SPA + PWA                                            ‚îÇ
‚îÇ  - 48 Componentes React                                     ‚îÇ
‚îÇ  - 13 Hooks personalizados                                  ‚îÇ
‚îÇ  - 2 Contextos globales (Auth, Caja)                        ‚îÇ
‚îÇ  - 17 Servicios                                             ‚îÇ
‚îÇ  - Responsive Design (Mobile-first)                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚Üï HTTP/REST API
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    CAPA DE APLICACI√ìN                        ‚îÇ
‚îÇ                        (Backend)                             ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  PHP 8.0+ Backend API                                       ‚îÇ
‚îÇ  - ~110 Endpoints RESTful                                   ‚îÇ
‚îÇ  - Autenticaci√≥n y autorizaci√≥n                             ‚îÇ
‚îÇ  - L√≥gica de negocio                                        ‚îÇ
‚îÇ  - Integraci√≥n AFIP                                         ‚îÇ
‚îÇ  - Sistema de cach√©                                         ‚îÇ
‚îÇ  - Validaciones y seguridad                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚Üï PDO/MySQL
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      CAPA DE DATOS                           ‚îÇ
‚îÇ                    (Base de Datos)                           ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  MySQL 8.0 Database                                         ‚îÇ
‚îÇ  - ~15 Tablas principales                                   ‚îÇ
‚îÇ  - √çndices optimizados                                      ‚îÇ
‚îÇ  - Transacciones ACID                                       ‚îÇ
‚îÇ  - Auditor√≠a completa                                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### Flujo de Datos

```
Usuario ‚Üí Frontend (React) ‚Üí API REST (PHP) ‚Üí Base de Datos (MySQL)
                                   ‚Üì
                            AFIP Web Services
                                   ‚Üì
                          Factura Electr√≥nica
```

---

## üì± M√≥dulos del Sistema

El sistema est√° organizado en **9 m√≥dulos principales**:

### 1Ô∏è‚É£ Dashboard
- **Ruta:** `/` (Inicio)
- **Componente:** `DashboardVentasCompleto.jsx`
- **Descripci√≥n:** Panel principal con m√©tricas en tiempo real
- **Caracter√≠sticas:**
  - Resumen de ventas del d√≠a
  - Estado de caja actual
  - Productos con bajo stock
  - Gr√°ficos de ventas
  - M√©tricas financieras

### 2Ô∏è‚É£ Control de Caja
- **Rutas:** `/control-caja`, `/historial-turnos`
- **Componentes:** `GestionCajaMejorada.jsx`, `HistorialTurnosPage.jsx`
- **Descripci√≥n:** Gesti√≥n completa del flujo de efectivo
- **Caracter√≠sticas:**
  - Apertura/cierre de caja
  - Registro de movimientos
  - Validaci√≥n de efectivo
  - Historial de turnos
  - Reportes de diferencias

### 3Ô∏è‚É£ Punto de Venta (POS)
- **Ruta:** `/punto-de-venta`
- **Componente:** `PuntoDeVentaStockOptimizado.jsx`
- **Descripci√≥n:** Interfaz principal de ventas
- **Caracter√≠sticas:**
  - B√∫squeda r√°pida de productos
  - Carrito de compras
  - M√∫ltiples m√©todos de pago
  - Facturaci√≥n AFIP
  - Impresi√≥n de tickets

### 4Ô∏è‚É£ Productos e Inventario
- **Rutas:** `/productos`, `/inventario`
- **Componentes:** `ProductosPage.jsx`, `InventarioInteligente.jsx`
- **Descripci√≥n:** Gesti√≥n completa de productos
- **Caracter√≠sticas:**
  - CRUD de productos
  - Control de stock
  - Categor√≠as y proveedores
  - Importaci√≥n masiva
  - Auditor√≠a de inventario

### 5Ô∏è‚É£ Reportes de Ventas
- **Ruta:** `/ventas`
- **Componente:** `ReporteVentasModerno.jsx`
- **Descripci√≥n:** An√°lisis detallado de ventas
- **Caracter√≠sticas:**
  - Filtros por fecha
  - Detalle de cada venta
  - Anulaci√≥n de ventas
  - Exportaci√≥n a Excel
  - An√°lisis con IA

### 6Ô∏è‚É£ An√°lisis Financiero
- **Ruta:** `/finanzas`
- **Componente:** `ModuloFinancieroCompleto.jsx`
- **Descripci√≥n:** Reportes financieros completos
- **Caracter√≠sticas:**
  - P&L (Profit & Loss)
  - Flujo de caja
  - Rentabilidad por producto
  - Gastos vs Ingresos
  - Gr√°ficos financieros

### 7Ô∏è‚É£ Usuarios
- **Ruta:** `/usuarios`
- **Componente:** `UsuariosPage.jsx`
- **Descripci√≥n:** Gesti√≥n de usuarios y permisos
- **Caracter√≠sticas:**
  - CRUD de usuarios
  - Asignaci√≥n de roles
  - Gesti√≥n de permisos
  - Auditor√≠a de acceso

### 8Ô∏è‚É£ Configuraci√≥n
- **Ruta:** `/configuracion`
- **Componente:** `ConfiguracionPage.jsx`
- **Descripci√≥n:** Configuraci√≥n general del sistema
- **Caracter√≠sticas:**
  - Datos empresariales
  - Configuraci√≥n AFIP
  - Configuraci√≥n de IA (OpenAI)
  - Par√°metros del sistema

### 9Ô∏è‚É£ Inteligencia Artificial
- **M√≥dulo transversal**
- **Servicios:** `openaiService.js`, `aiAnalytics.js`, `inventarioIAService.js`
- **Descripci√≥n:** Capacidades de IA distribuidas en todo el sistema
- **Caracter√≠sticas:**
  - An√°lisis inteligente de ventas
  - Diagn√≥stico financiero
  - Predicciones de inventario
  - Detecci√≥n de fraude
  - Recomendaciones autom√°ticas

---

## üìã Requisitos Previos

### Software Necesario

```bash
# Node.js y NPM
Node.js >= 18.0.0
NPM >= 8.0.0

# PHP
PHP >= 8.0
  - Extensiones: pdo_mysql, mysqli, json, mbstring, curl

# Base de Datos
MySQL >= 5.7 o MySQL 8.0+
MariaDB >= 10.6

# Servidor Web
Apache >= 2.4 con mod_rewrite
o NGINX >= 1.18

# Composer
Composer >= 2.0
```

### Recomendado para Windows

- **Laragon** (incluye Apache, PHP, MySQL, Node.js)
- **Git** para control de versiones

---

## üöÄ Instalaci√≥n

### 1. Clonar el Repositorio

```bash
git clone https://github.com/compucol89/tommyposV1.0.git kiosco
cd kiosco
```

### 2. Instalar Dependencias Frontend

```bash
npm install
```

### 3. Instalar Dependencias Backend

```bash
composer install
```

### 4. Configurar Base de Datos

Crear base de datos en MySQL:

```sql
CREATE DATABASE kiosco_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

### 5. Importar Estructura de Base de Datos

```bash
# Importar el archivo SQL de estructura (ubicar tu archivo .sql)
mysql -u root -p kiosco_db < database/schema.sql
```

### 6. Configurar Archivo de Conexi√≥n

Editar `api/db_config.php`:

```php
<?php
define('DB_HOST', 'localhost');
define('DB_PORT', '3306');
define('DB_NAME', 'kiosco_db');
define('DB_USER', 'root');
define('DB_PASS', '');
define('DB_CHARSET', 'utf8mb4');
```

### 7. Compilar Frontend

```bash
# Desarrollo
npm start

# Producci√≥n
npm run build
```

### 8. Iniciar el Sistema

#### Desarrollo (con Laragon):
1. Iniciar Laragon
2. El proyecto estar√° disponible en: `http://localhost/kiosco`

#### Desarrollo (servidor PHP integrado):
```bash
# Terminal 1: Frontend
npm start

# Terminal 2: Backend
php -S localhost:8000
```

---

## ‚öôÔ∏è Configuraci√≥n

### Configuraci√≥n de API (Frontend)

Archivo: `src/config/config.js`

```javascript
const CONFIG = {
  API_URL: process.env.NODE_ENV === 'production' 
    ? window.location.origin
    : 'http://localhost/kiosco',
  
  API_ENDPOINTS: {
    PRODUCTOS: '/api/productos.php',
    VENTAS: '/api/ventas_reales.php',
    USUARIOS: '/api/usuarios.php',
    // ... m√°s endpoints
  },
  
  VERSION: '1.0.1',
  APP_NAME: 'Tayrona Almac√©n',
  CURRENCY: 'ARS',
  CURRENCY_SYMBOL: '$'
};
```

### Configuraci√≥n AFIP

Archivo: `api/config_afip.php`

```php
<?php
$CONFIGURACION_AFIP = [
    'ambiente' => 'PRODUCCION', // PRODUCCION o TESTING
    // ... configuraci√≥n AFIP
];

$DATOS_FISCALES = [
    'cuit_empresa' => '20123456789',
    'razon_social' => 'Tu Raz√≥n Social',
    'domicilio_comercial' => 'Tu Direcci√≥n',
    // ... m√°s datos fiscales
];
```

### Configuraci√≥n de IA (OpenAI)

Archivo: `src/config/aiConfig.js`

```javascript
const AI_CONFIG = {
  OPENAI_API_KEY: 'tu-api-key-aqui',
  model: 'gpt-4',
  enabled: true
};
```

---

## üìÅ Estructura del Proyecto

```
kiosco/
‚îú‚îÄ‚îÄ üì± src/                           # Frontend React
‚îÇ   ‚îú‚îÄ‚îÄ components/                   # Componentes React (48 archivos)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ DashboardVentasCompleto.jsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PuntoDeVentaStockOptimizado.jsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ GestionCajaMejorada.jsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ProductosPage.jsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ productos/                # M√≥dulo de productos
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ components/           # 11 componentes
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ hooks/                # 5 hooks espec√≠ficos
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ... (m√°s componentes)
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ hooks/                        # Hooks personalizados (13)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useCajaApi.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useCajaStatus.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useStockManager.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useProductos.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ... (m√°s hooks)
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ services/                     # Servicios (17)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cajaService.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ openaiService.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ aiAnalytics.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inventarioIAService.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ... (m√°s servicios)
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ contexts/                     # Contextos React (2)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AuthContext.jsx           # Autenticaci√≥n global
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ CajaContext.jsx           # Estado de caja global
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ config/                       # Configuraci√≥n
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.js                 # Config principal
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ aiConfig.js               # Config de IA
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ utils/                        # Utilidades (4)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ cashValidation.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ imageCache.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ performance.js
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ toastNotifications.js
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ App.jsx                       # Componente ra√≠z
‚îÇ   ‚îú‚îÄ‚îÄ index.js                      # Entry point
‚îÇ   ‚îî‚îÄ‚îÄ index.css                     # Estilos globales
‚îÇ
‚îú‚îÄ‚îÄ üîß api/                           # Backend PHP
‚îÇ   ‚îú‚îÄ‚îÄ bd_conexion.php               # Conexi√≥n a BD
‚îÇ   ‚îú‚îÄ‚îÄ db_config.php                 # Credenciales BD
‚îÇ   ‚îú‚îÄ‚îÄ config.php                    # Config general
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üì¶ Productos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ productos.php
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ productos_pos_optimizado.php
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ subir_imagen_producto.php
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üí∞ Ventas
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ventas_reales.php
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ procesar_venta_ultra_rapida.php
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ anular_venta.php
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üè¶ Caja
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ gestion_caja_completa.php
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ pos_status.php
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üìä Reportes
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ reportes_financieros_precisos.php
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard_stats.php
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ finanzas_completo.php
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üë• Usuarios
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ usuarios.php
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ permisos_usuario.php
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ üßæ AFIP (15+ archivos)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ afip_hibrido_inteligente.php
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ afip_sdk_real.php
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ afip_directo.php
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ config_afip.php
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ ‚öôÔ∏è Configuraci√≥n
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ configuracion_empresarial.php
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ reset_sistema_empresarial.php
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ ... (~110 archivos PHP total)
‚îÇ
‚îú‚îÄ‚îÄ üóÑÔ∏è database/                     # Base de datos
‚îÇ   ‚îú‚îÄ‚îÄ migrations/                   # Migraciones
‚îÇ   ‚îî‚îÄ‚îÄ schema.sql                    # Estructura de BD
‚îÇ
‚îú‚îÄ‚îÄ üìö docs/                          # Documentaci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ MAPA_MAESTRO_SISTEMA_COMPLETO.md
‚îÇ   ‚îú‚îÄ‚îÄ ANALISIS_CONFIGURACION_BD.md
‚îÇ   ‚îî‚îÄ‚îÄ ... (m√°s documentaci√≥n)
‚îÇ
‚îú‚îÄ‚îÄ üñºÔ∏è img/                          # Im√°genes
‚îÇ   ‚îú‚îÄ‚îÄ productos/                    # Im√°genes de productos
‚îÇ   ‚îî‚îÄ‚îÄ no-image.svg
‚îÇ
‚îú‚îÄ‚îÄ üì¶ public/                        # Assets p√∫blicos
‚îÇ   ‚îú‚îÄ‚îÄ index.html
‚îÇ   ‚îú‚îÄ‚îÄ favicon.ico
‚îÇ   ‚îî‚îÄ‚îÄ img/
‚îÇ
‚îú‚îÄ‚îÄ üèóÔ∏è build/                         # Build de producci√≥n
‚îÇ   ‚îî‚îÄ‚îÄ ... (generado con npm run build)
‚îÇ
‚îú‚îÄ‚îÄ üìù Archivos de Configuraci√≥n
‚îÇ   ‚îú‚îÄ‚îÄ package.json                  # Dependencias NPM
‚îÇ   ‚îú‚îÄ‚îÄ composer.json                 # Dependencias PHP
‚îÇ   ‚îú‚îÄ‚îÄ tailwind.config.js            # Config Tailwind
‚îÇ   ‚îú‚îÄ‚îÄ postcss.config.js             # Config PostCSS
‚îÇ   ‚îî‚îÄ‚îÄ index.php                     # Entry point PHP
‚îÇ
‚îî‚îÄ‚îÄ üìñ README.md                      # Este archivo
```

---

## üóÑÔ∏è Base de Datos

### Tablas Principales

#### Productos
```sql
productos
‚îú‚îÄ‚îÄ id (PK)
‚îú‚îÄ‚îÄ codigo_barra
‚îú‚îÄ‚îÄ nombre
‚îú‚îÄ‚îÄ precio_venta
‚îú‚îÄ‚îÄ precio_costo
‚îú‚îÄ‚îÄ stock_actual
‚îú‚îÄ‚îÄ stock_minimo
‚îú‚îÄ‚îÄ categoria_id (FK)
‚îú‚îÄ‚îÄ proveedor_id (FK)
‚îî‚îÄ‚îÄ imagen_url
```

#### Ventas
```sql
ventas
‚îú‚îÄ‚îÄ id (PK)
‚îú‚îÄ‚îÄ fecha_hora
‚îú‚îÄ‚îÄ total
‚îú‚îÄ‚îÄ metodo_pago
‚îú‚îÄ‚îÄ descuento
‚îú‚îÄ‚îÄ usuario_id (FK)
‚îú‚îÄ‚îÄ turno_caja_id (FK)
‚îú‚îÄ‚îÄ factura_afip_numero
‚îî‚îÄ‚îÄ factura_afip_cae
```

#### Control de Caja
```sql
turnos_caja
‚îú‚îÄ‚îÄ id (PK)
‚îú‚îÄ‚îÄ usuario_id (FK)
‚îú‚îÄ‚îÄ fecha_apertura
‚îú‚îÄ‚îÄ fecha_cierre
‚îú‚îÄ‚îÄ monto_inicial
‚îú‚îÄ‚îÄ monto_final
‚îú‚îÄ‚îÄ diferencia
‚îî‚îÄ‚îÄ estado (abierto/cerrado)

movimientos_caja_detallados
‚îú‚îÄ‚îÄ id (PK)
‚îú‚îÄ‚îÄ turno_caja_id (FK)
‚îú‚îÄ‚îÄ tipo (ingreso/egreso)
‚îú‚îÄ‚îÄ monto
‚îú‚îÄ‚îÄ concepto
‚îî‚îÄ‚îÄ fecha_hora
```

#### Usuarios
```sql
usuarios
‚îú‚îÄ‚îÄ id (PK)
‚îú‚îÄ‚îÄ nombre
‚îú‚îÄ‚îÄ usuario (username)
‚îú‚îÄ‚îÄ password (hash)
‚îú‚îÄ‚îÄ role (admin/vendedor/cajero)
‚îî‚îÄ‚îÄ activo
```

### Relaciones

```
usuarios (1) ‚îÄ‚îÄ‚îÄ‚îÄ (N) ventas
usuarios (1) ‚îÄ‚îÄ‚îÄ‚îÄ (N) turnos_caja
turnos_caja (1) ‚îÄ‚îÄ‚îÄ‚îÄ (N) ventas
turnos_caja (1) ‚îÄ‚îÄ‚îÄ‚îÄ (N) movimientos_caja_detallados
productos (1) ‚îÄ‚îÄ‚îÄ‚îÄ (N) detalle_ventas
categorias (1) ‚îÄ‚îÄ‚îÄ‚îÄ (N) productos
proveedores (1) ‚îÄ‚îÄ‚îÄ‚îÄ (N) productos
```

---

## üåê API Endpoints

### Dashboard
```
GET  /api/dashboard_stats.php              # Estad√≠sticas generales
GET  /api/v2/dashboard_fintech.php         # Dashboard financiero
GET  /api/finanzas_completo.php            # Finanzas completas
```

### Productos
```
GET    /api/productos.php                  # Listar productos
POST   /api/productos.php                  # Crear producto
PUT    /api/productos.php?id={id}          # Actualizar producto
DELETE /api/productos.php?id={id}          # Eliminar producto
GET    /api/productos_pos_optimizado.php   # Productos para POS
POST   /api/subir_imagen_producto.php      # Subir imagen
```

### Ventas
```
GET   /api/ventas_reales.php               # Listar ventas
POST  /api/procesar_venta_ultra_rapida.php # Procesar venta
POST  /api/anular_venta.php                # Anular venta
```

### Control de Caja
```
GET   /api/gestion_caja_completa.php?action=estado_caja
POST  /api/gestion_caja_completa.php?action=abrir_caja
POST  /api/gestion_caja_completa.php?action=cerrar_caja
POST  /api/gestion_caja_completa.php?action=registrar_movimiento
GET   /api/gestion_caja_completa.php?action=historial_movimientos
GET   /api/gestion_caja_completa.php?action=historial_completo
GET   /api/pos_status.php                  # Estado de caja
```

### Usuarios
```
GET   /api/usuarios.php                    # Listar usuarios
POST  /api/usuarios.php                    # Crear usuario
PUT   /api/usuarios.php                    # Actualizar usuario
DELETE /api/usuarios.php                   # Eliminar usuario
POST  /api/validar_usuario.php             # Login
GET   /api/permisos_usuario.php            # Permisos
```

### Reportes
```
GET   /api/reportes_financieros_precisos.php  # Reportes financieros
GET   /api/finanzas_completo.php              # An√°lisis financiero
```

### Configuraci√≥n
```
GET   /api/configuracion_empresarial.php      # Config empresa
POST  /api/configuracion_empresarial.php      # Actualizar config
POST  /api/reset_sistema_empresarial.php      # Reset sistema
```

### AFIP
```
POST  /api/afip_hibrido_inteligente.php       # Generar comprobante
GET   /api/afip_directo.php                   # AFIP directo
POST  /api/afip_sdk_real.php                  # AFIP real
```

---

## üßæ Integraci√≥n AFIP

### M√©todos de Integraci√≥n

El sistema cuenta con **3 m√©todos de integraci√≥n AFIP**:

#### 1. AFIP H√≠brido Inteligente (Recomendado)
- **Archivo:** `api/afip_hibrido_inteligente.php`
- **Descripci√≥n:** Intenta usar AFIP real, si falla usa simulador v√°lido
- **Ventajas:** M√°xima confiabilidad, sin interrupciones
- **Uso:** Producci√≥n

#### 2. AFIP Directo
- **Archivo:** `api/afip_directo.php`
- **Descripci√≥n:** Integraci√≥n directa con Web Services AFIP
- **Ventajas:** R√°pido, sin dependencias externas
- **Uso:** Producci√≥n cuando hay certificados v√°lidos

#### 3. AFIP SDK Real
- **Archivo:** `api/afip_sdk_real.php`
- **Descripci√≥n:** Usa la librer√≠a oficial de AFIP SDK
- **Ventajas:** Oficial, bien mantenido
- **Uso:** Producci√≥n con certificados

### Configuraci√≥n AFIP

1. **Obtener certificados AFIP** (.crt y .key)
2. Colocarlos en: `api/certificados/`
3. Configurar `api/config_afip.php`:

```php
$CONFIGURACION_AFIP = [
    'ambiente' => 'PRODUCCION', // PRODUCCION o TESTING
    'urls_produccion' => [
        'wsaa' => 'https://wsaa.afip.gov.ar/ws/services/LoginCms',
        'wsfe' => 'https://servicios1.afip.gov.ar/wsfev1/service.asmx'
    ]
];

$DATOS_FISCALES = [
    'cuit_empresa' => '20123456789',
    'razon_social' => 'Tu Raz√≥n Social',
    'punto_venta' => 1,
    'condicion_iva' => 'MONOTRIBUTO'
];
```

### Tipos de Comprobantes

- **Factura A:** Para responsables inscriptos
- **Factura B:** Para consumidores finales
- **Factura C:** Para monotributistas (sin IVA discriminado)

### Proceso de Facturaci√≥n

```
1. Venta realizada ‚Üí PuntoDeVentaStockOptimizado
2. Si factura AFIP activada ‚Üí procesar_venta_ultra_rapida.php
3. Llamar servicio AFIP ‚Üí afip_hibrido_inteligente.php
4. Generar comprobante ‚Üí CAE + N√∫mero
5. Guardar en BD ‚Üí ventas.factura_afip_numero, ventas.factura_afip_cae
6. Imprimir ticket ‚Üí TicketProfesional.jsx (incluye datos fiscales)
```

---

## üîí Seguridad

### Medidas Implementadas

#### Autenticaci√≥n
- Hashing de contrase√±as con `password_hash()` (bcrypt)
- Validaci√≥n de credenciales
- Sistema de sesiones PHP
- Contexto de autenticaci√≥n React (AuthContext)

#### Autorizaci√≥n
- Sistema de roles (admin, vendedor, cajero)
- Permisos granulares por m√≥dulo
- Validaci√≥n en frontend y backend
- Guards de rutas

#### Protecci√≥n de Datos
- Preparaci√≥n de queries con PDO (previene SQL injection)
- Validaci√≥n de inputs en frontend y backend
- Sanitizaci√≥n de datos
- Headers de seguridad HTTP

#### CORS
- Configuraci√≥n CORS para APIs
- Whitelisting de dominios permitidos

#### Auditor√≠a
- Logs de operaciones AFIP
- Auditor√≠a de inventario
- Registro de movimientos de caja
- Historial de acciones de usuarios

---

## üë• Sistema de Permisos

### Roles

#### üî¥ Admin (Administrador)
- **Acceso:** Todos los m√≥dulos
- **Permisos:**
  - ‚úÖ Dashboard
  - ‚úÖ Control de Caja
  - ‚úÖ Historial de Turnos
  - ‚úÖ Punto de Venta
  - ‚úÖ Reporte de Ventas
  - ‚úÖ Inventario
  - ‚úÖ Productos
  - ‚úÖ An√°lisis Financiero
  - ‚úÖ Usuarios (CRUD)
  - ‚úÖ Configuraci√≥n

#### üîµ Vendedor
- **Acceso:** M√≥dulos operativos
- **Permisos:**
  - ‚úÖ Dashboard
  - ‚úÖ Punto de Venta
  - ‚úÖ Productos (solo lectura)
  - ‚ùå Control de Caja
  - ‚ùå Reportes Financieros
  - ‚ùå Usuarios
  - ‚ùå Configuraci√≥n

#### üü¢ Cajero
- **Acceso:** M√≥dulos de caja y venta
- **Permisos:**
  - ‚úÖ Dashboard
  - ‚úÖ Control de Caja
  - ‚úÖ Historial de Turnos
  - ‚úÖ Punto de Venta
  - ‚ùå Productos (CRUD)
  - ‚ùå Reportes Financieros
  - ‚ùå Usuarios
  - ‚ùå Configuraci√≥n

### Implementaci√≥n

Frontend: `src/hooks/usePermisos.js`
```javascript
const { hasAccess, getFilteredMenuItems } = usePermisos(currentUser);
```

Backend: `api/permisos_usuario.php`
```php
// Validaci√≥n de permisos en cada endpoint
```

---

## üîÑ Flujo de Trabajo

### Flujo Operativo Diario

```
1. LOGIN
   Usuario ingresa credenciales ‚Üí LoginPage.jsx
   ‚Üì
   Validaci√≥n ‚Üí api/validar_usuario.php
   ‚Üì
   Sesi√≥n iniciada ‚Üí AuthContext

2. APERTURA DE CAJA
   Cajero/Admin ‚Üí GestionCajaMejorada.jsx
   ‚Üì
   Registrar monto inicial ‚Üí api/gestion_caja_completa.php
   ‚Üì
   Turno de caja ABIERTO ‚Üí Estado global (CajaContext)

3. VENTAS
   Vendedor ‚Üí PuntoDeVentaStockOptimizado.jsx
   ‚Üì
   Validaci√≥n: Caja ABIERTA ‚Üí useCajaStatus.js
   ‚Üì
   Agregar productos ‚Üí B√∫squeda optimizada
   ‚Üì
   Seleccionar m√©todo de pago ‚Üí Descuentos autom√°ticos
   ‚Üì
   Procesar venta ‚Üí api/procesar_venta_ultra_rapida.php
   ‚Üì
   (Opcional) Facturar AFIP ‚Üí api/afip_hibrido_inteligente.php
   ‚Üì
   Imprimir ticket ‚Üí TicketProfesional.jsx
   ‚Üì
   Sincronizar caja ‚Üí cashSyncService.js

4. CIERRE DE CAJA
   Cajero/Admin ‚Üí GestionCajaMejorada.jsx
   ‚Üì
   Contar efectivo ‚Üí Validaci√≥n contra ventas
   ‚Üì
   Cerrar turno ‚Üí api/gestion_caja_completa.php
   ‚Üì
   Generar reporte de cierre ‚Üí PDF

5. REPORTES
   Admin ‚Üí M√≥dulos de reportes
   ‚Üì
   An√°lisis de ventas, finanzas, inventario
   ‚Üì
   Exportar a Excel ‚Üí XLSX
```

---

## üß© Componentes Principales

### Frontend (48 componentes activos)

#### P√°ginas Principales (13)
1. `DashboardVentasCompleto.jsx` - Dashboard principal
2. `PuntoDeVentaStockOptimizado.jsx` - POS
3. `GestionCajaMejorada.jsx` - Control de caja
4. `HistorialTurnosPage.jsx` - Historial de turnos
5. `ProductosPage.jsx` - Gesti√≥n de productos
6. `InventarioInteligente.jsx` - Inventario con IA
7. `ReporteVentasModerno.jsx` - Reportes de ventas
8. `ModuloFinancieroCompleto.jsx` - An√°lisis financiero
9. `UsuariosPage.jsx` - Gesti√≥n de usuarios
10. `ConfiguracionPage.jsx` - Configuraci√≥n
11. `LoginPage.jsx` - Login
12. `IndicadorEstadoCaja.jsx` - Indicador de caja (topbar)
13. `NotificacionesMovimientos.jsx` - Notificaciones

#### Sub-componentes (35)
- **Dashboard:** `DashboardResumenCaja.jsx`
- **Caja:** `ModalAperturaCaja.jsx`, `MetricasCaja.jsx`, `CajaStatusIndicator.jsx`, `ReportesEfectivoPeriodo.jsx`, `ReportesDiferenciasCajero.jsx`
- **POS:** `PaymentModalSleepyCashierProof.jsx`, `TicketProfesional.jsx`, `StockAlerts.jsx`
- **Ventas:** `VentaDetalleCompleto.jsx`, `AnalisisInteligente.jsx`, `DiagnosticoFinanciero.jsx`
- **Config:** `ConfiguracionIA.jsx`, `ConfiguracionFacturacion.jsx`, `AFIPStatusIndicator.jsx`, `PermissionGuard.jsx`
- **Productos:** 18 archivos en carpeta `productos/` (11 componentes + 5 hooks + helpers)

---

## üé£ Hooks Personalizados

### Control de Caja (3)
- `useCajaApi.js` - API calls de caja
- `useCajaLogic.js` - L√≥gica de negocio de caja
- `useCajaStatus.js` - Estado y validaci√≥n de caja

### Productos (2)
- `useStockManager.js` - Gesti√≥n inteligente de stock
- `useProductos.js` - CRUD de productos

### Dashboard (2)
- `useDashboardFintech.js` - M√©tricas financieras
- `useExportManager.js` - Exportaci√≥n de datos

### B√∫squeda (3)
- `useEnterpriseSearch.js` - B√∫squeda enterprise-grade
- `useHybridPOSSearch.js` - B√∫squeda h√≠brida POS
- `usePOSProducts.js` - Productos para POS

### Sistema (3)
- `usePermisos.js` - Sistema de permisos
- `useDebounce.js` - Debouncing de inputs
- `ToastContext.jsx` - Notificaciones toast

---

## üîß Servicios

### APIs (2)
- `api.js` - Cliente HTTP base
- `cajaService.js` - Servicio de caja

### Reportes (1)
- `reportesService.js` - Generaci√≥n de reportes

### Configuraci√≥n (3)
- `configEmpresarialService.js` - Config empresarial
- `configService.js` - Config general
- `permisosService.js` - Gesti√≥n de permisos

### Ventas (1)
- `descuentosService.js` - Descuentos autom√°ticos

### Inteligencia Artificial (5)
- `openaiService.js` - Integraci√≥n OpenAI
- `aiAnalytics.js` - Analytics con IA
- `inventarioIAService.js` - IA para inventario
- `pedidosIAService.js` - IA para pedidos
- `antiFraudEngine.js` - Detecci√≥n de fraude

### Seguridad (3)
- `seguridadInventarioService.js` - Seguridad de inventario
- `validationSuite.js` - Suite de validaciones
- `auditLogger.js` - Logger de auditor√≠a

### Sistema (2)
- `sistemaService.js` - Utilidades del sistema
- `cashSyncService.js` - Sincronizaci√≥n de caja

---

## üìñ Uso del Sistema

### 1. Primer Inicio

1. **Crear usuario administrador** (directamente en BD o con script)
2. **Ingresar al sistema** con credenciales de admin
3. **Configurar datos empresariales** en Configuraci√≥n
4. **Configurar AFIP** (si se requiere facturaci√≥n electr√≥nica)
5. **Crear categor√≠as** de productos
6. **Crear usuarios** adicionales (vendedores, cajeros)

### 2. Gesti√≥n Diaria

#### Apertura de Turno
1. Ir a **Control de Caja**
2. Hacer clic en **Abrir Caja**
3. Ingresar monto inicial de efectivo
4. Confirmar apertura

#### Realizar Ventas
1. Ir a **Punto de Venta**
2. Buscar productos (por nombre o c√≥digo de barras)
3. Agregar al carrito
4. Seleccionar m√©todo de pago
5. (Opcional) Activar factura AFIP
6. Confirmar venta
7. Imprimir ticket

#### Cierre de Turno
1. Ir a **Control de Caja**
2. Hacer clic en **Cerrar Caja**
3. Contar efectivo real
4. Ingresar monto contado
5. Sistema calcula diferencia
6. Confirmar cierre
7. Descargar reporte de cierre

### 3. Gesti√≥n de Productos

#### Agregar Producto
1. Ir a **Productos**
2. Hacer clic en **Nuevo Producto**
3. Completar datos:
   - C√≥digo de barras
   - Nombre
   - Precio de venta
   - Precio de costo
   - Stock inicial
   - Categor√≠a
   - Proveedor
4. (Opcional) Subir imagen
5. Guardar

#### Actualizar Stock
1. Ir a **Inventario**
2. Buscar producto
3. Ajustar stock
4. Registrar motivo
5. Guardar

### 4. Reportes

#### Reporte de Ventas
1. Ir a **Reporte de Ventas**
2. Seleccionar rango de fechas
3. (Opcional) Filtrar por m√©todo de pago
4. Ver detalle de ventas
5. (Opcional) Exportar a Excel

#### An√°lisis Financiero
1. Ir a **An√°lisis**
2. Seleccionar per√≠odo
3. Ver P&L, flujo de caja, rentabilidad
4. (Opcional) Usar an√°lisis con IA

---

## üõ†Ô∏è Mantenimiento

### Backup de Base de Datos

```bash
# Exportar base de datos
mysqldump -u root -p kiosco_db > backup_kiosco_$(date +%Y%m%d).sql

# Restaurar base de datos
mysql -u root -p kiosco_db < backup_kiosco_YYYYMMDD.sql
```

### Limpieza de Logs

Los logs se guardan en `api/logs/`:
- `afip_errors.log` - Errores de AFIP
- `afip_operations.log` - Operaciones AFIP
- `audit_backup_*.log` - Auditor√≠a (se rotan diariamente)

**Recomendaci√≥n:** Limpiar logs antiguos cada mes.

### Actualizaci√≥n del Sistema

```bash
# 1. Backup de BD
mysqldump -u root -p kiosco_db > backup.sql

# 2. Pull de √∫ltimos cambios
git pull origin main

# 3. Actualizar dependencias
npm install
composer update

# 4. Rebuild frontend
npm run build

# 5. Verificar funcionamiento
```

### Optimizaci√≥n de Base de Datos

```sql
-- Optimizar tablas
OPTIMIZE TABLE productos, ventas, turnos_caja;

-- Analizar tablas
ANALYZE TABLE productos, ventas, turnos_caja;

-- Verificar integridad
CHECK TABLE productos, ventas, turnos_caja;
```

---

## üêõ Troubleshooting

### Problemas Comunes

#### Error de Conexi√≥n a BD
```
Error: Could not connect to MySQL
```
**Soluci√≥n:**
1. Verificar que MySQL est√© corriendo
2. Revisar credenciales en `api/db_config.php`
3. Verificar que la BD existe

#### Frontend no carga
```
P√°gina en blanco
```
**Soluci√≥n:**
1. Verificar que se compil√≥ el build: `npm run build`
2. Verificar que Apache/NGINX est√° corriendo
3. Revisar consola del navegador (F12)

#### Caja no se puede abrir
```
No se puede abrir caja
```
**Soluci√≥n:**
1. Verificar que no haya un turno abierto
2. Revisar permisos del usuario
3. Verificar conexi√≥n API

#### AFIP no funciona
```
Error al generar comprobante AFIP
```
**Soluci√≥n:**
1. Verificar certificados en `api/certificados/`
2. Revisar configuraci√≥n en `api/config_afip.php`
3. Verificar logs en `api/logs/afip_errors.log`
4. Intentar con sistema h√≠brido (fallback autom√°tico)

#### Stock negativo
```
Stock no puede ser negativo
```
**Soluci√≥n:**
1. Ir a **Inventario**
2. Ajustar stock manualmente
3. Registrar el motivo del ajuste

### Logs del Sistema

#### Frontend (Navegador)
```javascript
// Abrir consola del navegador: F12
// Buscar errores en la pesta√±a Console
```

#### Backend (PHP)
```bash
# Laragon:
C:\laragon\bin\apache\apache-2.4.X\logs\error.log

# Linux:
/var/log/apache2/error.log
/var/log/nginx/error.log
```

#### AFIP
```bash
# Logs de AFIP
api/logs/afip_errors.log
api/logs/afip_operations.log
```

---

## üìÑ Licencia

Este proyecto est√° bajo la licencia **MIT**.

```
MIT License

Copyright (c) 2025 Tayrona POS Team

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
```

---

## üìû Contacto y Soporte

### Equipo de Desarrollo

- **Email:** infocompucol@gmail.com
- **GitHub:** [compucol89/tommyposV1.0](https://github.com/compucol89/tommyposV1.0)

### Reporte de Bugs

Si encuentras alg√∫n bug, por favor:

1. Abre un Issue en GitHub
2. Describe el problema detalladamente
3. Incluye pasos para reproducirlo
4. Adjunta screenshots si es posible
5. Indica tu entorno (OS, versi√≥n PHP, MySQL, etc.)

### Contribuciones

¬°Las contribuciones son bienvenidas!

1. Fork el proyecto
2. Crea una rama para tu feature (`git checkout -b feature/AmazingFeature`)
3. Commit tus cambios (`git commit -m 'Add some AmazingFeature'`)
4. Push a la rama (`git push origin feature/AmazingFeature`)
5. Abre un Pull Request

---

## üìä Estad√≠sticas del Proyecto

### C√≥digo

- **Componentes React:** 48 activos
- **Hooks personalizados:** 13 principales + 5 en productos = 18 total
- **Servicios:** 17
- **Contextos:** 2
- **Utilidades:** 4
- **Endpoints PHP:** ~110 funcionales
- **Total archivos frontend:** ~89 archivos .js/.jsx
- **Total archivos backend:** ~110 archivos .php

### M√≥dulos

- **M√≥dulos principales:** 9
- **P√°ginas:** 13
- **Sub-componentes:** 35
- **Dependencias NPM:** 28
- **Dependencias PHP:** 1 (AFIP SDK)

---

## üéØ Roadmap

### Versi√≥n 1.1 (Pr√≥ximamente)
- [ ] App m√≥vil con React Native
- [ ] Multi-tienda (varias sucursales)
- [ ] Sincronizaci√≥n en la nube
- [ ] Reportes avanzados con BI

### Versi√≥n 1.2
- [ ] Integraci√≥n con Mercado Pago
- [ ] Programa de fidelizaci√≥n de clientes
- [ ] Pedidos online
- [ ] Delivery integrado

### Versi√≥n 2.0
- [ ] Migraci√≥n a TypeScript
- [ ] GraphQL API
- [ ] Microservicios
- [ ] PWA offline-first

---

## üôè Agradecimientos

Este sistema fue desarrollado con dedicaci√≥n para ayudar a peque√±os comercios en Argentina a digitalizar sus operaciones.

**Tecnolog√≠as utilizadas:**
- React.js
- PHP
- MySQL
- Tailwind CSS
- Chart.js
- AFIP SDK
- Y muchas m√°s...

---

<div align="center">

**üè™ Tayrona Almac√©n - Sistema POS Kiosco v1.0.1**

Desarrollado con ‚ù§Ô∏è para comercios argentinos

[üåü Star en GitHub](https://github.com/compucol89/tommyposV1.0) ‚Ä¢ [üìß Contacto](mailto:infocompucol@gmail.com)

</div>
