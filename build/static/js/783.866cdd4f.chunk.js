/*! For license information please see 783.866cdd4f.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunktayrona_pos=self.webpackChunktayrona_pos||[]).push([[783],{783:(e,s,t)=>{t.r(s),t.d(s,{default:()=>d});var a=t(950);const n=(0,t(230).A)("printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);var r=t(479),o=t(405),i=t(414);const l=e=>{var s;let{venta:t,onStatusUpdate:n}=e;const[r,o]=(0,a.useState)(null),[l,d]=(0,a.useState)(!1),[c,m]=(0,a.useState)(0),[x,u]=(0,a.useState)(!1),[p,h]=(0,a.useState)(null),b=(0,a.useRef)(null),v=(0,a.useRef)("undefined"!==typeof Worker),f={PROCESSING:{icon:"\u23f3",color:"text-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-200",message:"Generando factura electr\xf3nica...",showSpinner:!0},AUTORIZADO:{icon:"\u2705",color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-200",message:"Factura autorizada por AFIP",showSpinner:!1},ERROR:{icon:"\u274c",color:"text-red-600",bgColor:"bg-red-50",borderColor:"border-red-200",message:"Error en facturaci\xf3n",showSpinner:!1},QUEUE_ERROR:{icon:"\u26a0\ufe0f",color:"text-yellow-600",bgColor:"bg-yellow-50",borderColor:"border-yellow-200",message:"Error en cola de procesamiento",showSpinner:!1}},g=(0,a.useCallback)((()=>{if(v.current&&!b.current)try{b.current=new Worker("/workers/afip-worker.js"),b.current.onmessage=e=>{const{type:s,ventaId:a,data:r}=e.data;if(!a||a===(null===t||void 0===t?void 0:t.venta_id))switch(s){case"AFIP_STATUS_UPDATE":o(r.status),m(r.attempts),n&&n(r.status);break;case"AFIP_FINAL_STATUS":d(!1),o(r.status),"completed"===r.status.status&&r.status.datos_fiscales&&o({...r.status,status:"AUTORIZADO",datos_fiscales:r.status.datos_fiscales}),n&&n(r.status),b.current.postMessage({type:"GET_METRICS"});break;case"AFIP_TIMEOUT":d(!1),o({status:"ERROR",message:"Tiempo l\xedmite de procesamiento excedido"});break;case"AFIP_POLLING_ERROR":console.warn("Error en polling AFIP:",r.error),r.willRetry||(d(!1),o({status:"ERROR",message:r.error}));break;case"METRICS_RESPONSE":h(r);break;case"ERROR":console.error("Error en Web Worker AFIP:",r.error),j()}},b.current.onerror=e=>{console.error("Error en Web Worker:",e),j()}}catch(e){console.error("Error inicializando Worker:",e),v.current=!1}}),[null===t||void 0===t?void 0:t.venta_id,n]),j=(0,a.useCallback)((()=>{console.log("Fallback a polling tradicional"),v.current=!1,b.current&&(b.current.terminate(),b.current=null),_()}),[]),_=(0,a.useCallback)((async()=>{if(null!==t&&void 0!==t&&t.venta_id&&l)try{const e=await fetch(`/kiosco/api/afip_async_processor.php?action=status&venta_id=${t.venta_id}`);if(!e.ok)throw new Error(`HTTP ${e.status}`);const s=await e.json();o(s),m((e=>e+1)),n&&n(s),"completed"!==s.status&&"failed"!==s.status||(d(!1),"completed"===s.status&&s.datos_fiscales&&o({...s,status:"AUTORIZADO",datos_fiscales:s.datos_fiscales}))}catch(e){console.error("Error verificando estado AFIP:",e),m((e=>e+1)),c>=10&&(d(!1),o({status:"ERROR",message:"Error de conectividad verificando estado"}))}}),[null===t||void 0===t?void 0:t.venta_id,n,c,l]);(0,a.useEffect)((()=>{var e;"PROCESSING"!==(null===t||void 0===t||null===(e=t.datos_fiscales)||void 0===e?void 0:e.estado_fiscal)||l||(d(!0),m(0),o({status:"PROCESSING",message:t.datos_fiscales.mensaje||"Procesando factura...",tiempo_estimado:t.datos_fiscales.tiempo_estimado}),v.current?(g(),b.current?b.current.postMessage({type:"START_POLLING",data:{ventaId:t.venta_id,options:{interval:2e3,maxAttempts:25,backoffMultiplier:1.15}}}):j()):_())}),[null===t||void 0===t||null===(s=t.datos_fiscales)||void 0===s?void 0:s.estado_fiscal,l,g,j,_]),(0,a.useEffect)((()=>{let e;return l&&"PROCESSING"===(null===r||void 0===r?void 0:r.status)&&!v.current&&(e=setInterval(_,3e3),_()),()=>{e&&clearInterval(e)}}),[l,null===r||void 0===r?void 0:r.status,_]),(0,a.useEffect)((()=>()=>{b.current&&(b.current.postMessage({type:"STOP_POLLING",data:{ventaId:null===t||void 0===t?void 0:t.venta_id}}),b.current.terminate(),b.current=null)}),[null===t||void 0===t?void 0:t.venta_id]);const N=()=>(0,i.jsx)("div",{className:"inline-block animate-spin rounded-full h-4 w-4 border-b-2 border-current"}),y=e=>{let{status:s}=e;const t=20,a=28*Math.PI,n=Math.min(c/10*100,90),r=`${a} ${a}`,o=a-n/100*a;return(0,i.jsxs)("div",{className:"relative inline-flex items-center justify-center",children:[(0,i.jsxs)("svg",{height:40,width:40,className:"transform -rotate-90",children:[(0,i.jsx)("circle",{stroke:"currentColor",fill:"transparent",strokeWidth:3,strokeDasharray:r,style:{strokeDashoffset:o},r:14,cx:t,cy:t,className:"text-blue-500 transition-all duration-300"}),(0,i.jsx)("circle",{stroke:"currentColor",fill:"transparent",strokeWidth:3,r:14,cx:t,cy:t,className:"text-gray-200"})]}),(0,i.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,i.jsxs)("span",{className:"text-xs font-bold text-blue-600",children:[Math.round(n),"%"]})})]})};if(null===t||void 0===t||!t.datos_fiscales)return null;const R=(null===r||void 0===r?void 0:r.status)||t.datos_fiscales.estado_fiscal,A=f[R]||f.PROCESSING;return(0,i.jsxs)("div",{className:`rounded-lg border ${A.borderColor} ${A.bgColor} p-3 mb-4`,children:[(0,i.jsxs)("div",{className:"flex items-center justify-between",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,i.jsx)("div",{className:`text-lg ${A.color}`,children:A.showSpinner?(0,i.jsx)(N,{}):A.icon}),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsx)("div",{className:`font-medium text-sm ${A.color}`,children:A.message}),"PROCESSING"===R&&(0,i.jsxs)("div",{className:"text-xs text-gray-600 mt-1",children:[(null===r||void 0===r?void 0:r.tiempo_estimado)&&(0,i.jsxs)("span",{children:["Tiempo estimado: ",r.tiempo_estimado]}),c>0&&(0,i.jsxs)("span",{className:"ml-2",children:["\u2022 Verificaci\xf3n #",c]})]}),"AUTORIZADO"===R&&(null===r||void 0===r?void 0:r.cae)&&(0,i.jsxs)("div",{className:"text-xs text-gray-600 mt-1",children:["CAE: ",r.cae]}),("ERROR"===R||"QUEUE_ERROR"===R)&&(null===r||void 0===r?void 0:r.error)&&(0,i.jsx)("div",{className:"text-xs text-red-600 mt-1",children:r.error}),v.current&&"PROCESSING"===R&&(0,i.jsxs)("div",{className:"text-xs text-blue-600 mt-1 flex items-center",children:[(0,i.jsx)("span",{className:"w-2 h-2 bg-blue-500 rounded-full mr-1 animate-pulse"}),"Procesamiento optimizado"]}),p&&x&&(0,i.jsx)("div",{className:"text-xs text-gray-600 mt-1",children:(0,i.jsxs)("span",{children:["Tasa \xe9xito: ",p.success_rate||"N/A","%"]})})]})]}),"PROCESSING"===R&&(0,i.jsx)(y,{status:R}),(0,i.jsx)("button",{onClick:()=>u(!x),className:"text-xs text-gray-500 hover:text-gray-700 ml-2",children:x?"\u25bc":"\u25b6"})]}),x&&r&&(0,i.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:(0,i.jsxs)("div",{className:"text-xs text-gray-600 space-y-1",children:[(0,i.jsxs)("div",{children:["Estado: ",(0,i.jsx)("span",{className:"font-mono",children:r.status})]}),(0,i.jsxs)("div",{children:["Venta ID: ",(0,i.jsx)("span",{className:"font-mono",children:t.venta_id})]}),r.created_at&&(0,i.jsxs)("div",{children:["Iniciado: ",(0,i.jsx)("span",{className:"font-mono",children:r.created_at})]}),r.processing_time&&(0,i.jsxs)("div",{children:["Tiempo procesamiento: ",(0,i.jsxs)("span",{className:"font-mono",children:[r.processing_time,"s"]})]}),r.retry_count>0&&(0,i.jsxs)("div",{children:["Reintentos: ",(0,i.jsx)("span",{className:"font-mono",children:r.retry_count})]}),v.current&&(0,i.jsxs)("div",{children:["Web Worker: ",(0,i.jsx)("span",{className:"font-mono text-green-600",children:"\u2713 Activo"})]}),p&&(0,i.jsxs)("div",{children:["M\xe9tricas: ",(0,i.jsxs)("span",{className:"font-mono",children:[p.total_processed||0," proc."]})]})]})}),"ERROR"===R&&(0,i.jsx)("div",{className:"mt-3 pt-3 border-t border-gray-200",children:(0,i.jsx)("button",{onClick:()=>{d(!0),m(0),v.current&&b.current?b.current.postMessage({type:"START_POLLING",data:{ventaId:t.venta_id,options:{interval:2e3,maxAttempts:15}}}):_()},className:"text-xs bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600 transition-colors",children:"\ud83d\udd04 Reintentar verificaci\xf3n"})})]})},d=e=>{var s,t,d,c,m,x,u,p,h,b,v,f,g;let{venta:j,onClose:_,show:N=!0}=e;const{currentUser:y}=(0,o.As)(),R=(0,a.useRef)(),[A,C]=(0,a.useState)(j);if(!N||!j)return null;const E=A||j,O=e=>{if(!e)return null;try{return`https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(e)}`}catch(s){return console.error("Error generando QR:",s),null}},S=()=>E.datos_fiscales?E.datos_fiscales.cae&&"AUTORIZADO"===E.datos_fiscales.estado_fiscal:E.comprobante_fiscal&&E.comprobante_fiscal.cae,w=()=>{if(!S())return null;if(E.datos_fiscales&&"AUTORIZADO"===E.datos_fiscales.estado_fiscal){const e=E.datos_fiscales;return{cae:e.cae,numero_comprobante_fiscal:e.numero_comprobante_fiscal,tipo_comprobante:e.tipo_comprobante,codigo_barras:e.codigo_barras,qr_url:O(e.qr_data),fecha_vencimiento_cae:e.fecha_vencimiento_cae,punto_venta:e.punto_venta}}if(E.comprobante_fiscal){const e=E.comprobante_fiscal;return{cae:e.cae,numero_comprobante_fiscal:e.numero_comprobante_fiscal,tipo_comprobante:e.tipo_comprobante,codigo_barras:e.codigo_barras,qr_url:O(e.qr_data)}}return null},I=e=>{if(!e)return"$0";const s=parseFloat(e);return s%1===0?`$${s.toLocaleString("es-AR",{minimumFractionDigits:0,maximumFractionDigits:0})}`:`$${s.toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})}`},T=e=>`$${(parseFloat(e)||0).toLocaleString("es-AR",{minimumFractionDigits:2,maximumFractionDigits:2})}`,k=()=>{if(j.numero_comprobante)return j.numero_comprobante;const e=new Date(j.fecha||new Date);return`VTA-${e.getDate().toString().padStart(2,"0")}${e.toLocaleDateString("es",{month:"short"}).toUpperCase()}${e.getFullYear().toString().slice(-2)}${(j.venta_id||j.id||Math.floor(999*Math.random())+1).toString().padStart(3,"0")}`},P=(()=>{const e=parseFloat(j.subtotal||0),s=parseFloat(j.discount||0),t=e-s;return{subtotal:e,descuento:s,totalNeto:t,iva:21*t/121,otrosImpuestos:0,totalAPagar:t}})(),F=E.cart||E.productos||[],U=k();return(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex justify-center items-center z-50 p-4",children:(0,i.jsxs)("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-[350px] max-h-[90vh] overflow-y-auto",children:[(0,i.jsxs)("div",{ref:R,className:"p-3",style:{fontFamily:"Courier New, monospace",fontSize:"9px",lineHeight:"1.1"},children:[(0,i.jsxs)("div",{className:"text-center mb-2",children:[(0,i.jsx)("div",{className:"text-sm font-bold",children:"TAYRONA STORE"}),(0,i.jsx)("div",{children:"Paraguay 3809 - Palermo, CABA"}),(0,i.jsx)("div",{children:"CUIT/CUIL: 30-71885087-4"}),(0,i.jsx)("div",{children:"WhatsApp: 11 3313-8651"})]}),(0,i.jsx)("div",{className:"border-t border-dashed border-black my-2"}),(0,i.jsx)("div",{className:"text-center bg-gray-100 py-1 px-2 font-bold text-xs border border-dashed border-black mb-2",children:S()?`COMPROBANTE FISCAL - ${(null===(s=w())||void 0===s?void 0:s.tipo_comprobante)||"FACTURA"}`:"TICKET NO V\xc1LIDO COMO FACTURA"}),(0,i.jsxs)("div",{className:"mb-2 text-xs",children:[(0,i.jsxs)("div",{children:["Comprobante #: ",(0,i.jsx)("span",{className:"font-bold",children:U})]}),(0,i.jsxs)("div",{children:["Fecha: ",(()=>{const e=new Date(j.fecha||new Date);return`${e.getDate().toString().padStart(2,"0")}/${(e.getMonth()+1).toString().padStart(2,"0")}/${e.getFullYear()} ${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")} hs`})()]}),(0,i.jsxs)("div",{children:["Cliente: ",(null===(t=j.cliente)||void 0===t?void 0:t.name)||j.cliente_nombre||"Consumidor Final"]}),(0,i.jsxs)("div",{children:["Atendido por: ",(null===y||void 0===y?void 0:y.username)||(null===y||void 0===y?void 0:y.name)||"Administrador"]})]}),(0,i.jsx)("div",{className:"border-t border-dashed border-black my-2"}),(0,i.jsxs)("div",{className:"mb-2",children:[(0,i.jsx)("div",{className:"text-xs font-bold mb-1",children:(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",gap:"2px"},children:[(0,i.jsx)("span",{children:"DESCRIPCI\xd3N"}),(0,i.jsx)("span",{className:"text-center",children:"CANT"}),(0,i.jsx)("span",{className:"text-right",children:"PRECIO"}),(0,i.jsx)("span",{className:"text-right",children:"IMPORTE"})]})}),(0,i.jsx)("div",{className:"border-t border-gray-300 mb-1"}),F.map(((e,s)=>{const t=!1!==e.aplica_descuento_forma_pago;return(0,i.jsxs)("div",{className:"text-xs mb-1",children:[(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr 1fr",gap:"2px",alignItems:"start"},children:[(0,i.jsxs)("span",{className:"truncate",title:e.name||e.nombre,children:[!t&&"\ud83d\udd12 ",(e.name||e.nombre||"").slice(0,t?18:16)]}),(0,i.jsx)("span",{className:"text-center",children:e.quantity||e.cantidad}),(0,i.jsx)("span",{className:"text-right",children:I(e.price||e.precio_unitario)}),(0,i.jsx)("span",{className:"text-right font-medium",children:I((e.price||e.precio_unitario)*(e.quantity||e.cantidad))})]}),!t&&(0,i.jsx)("div",{className:"text-xs text-gray-500 ml-1",children:"(Exento de descuentos)"})]},s)}))]}),(0,i.jsx)("div",{className:"border-t border-dashed border-black my-2"}),(0,i.jsxs)("div",{className:"text-xs space-y-1",children:[(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{children:"SUBTOTAL:"}),(0,i.jsx)("span",{children:I(P.subtotal)})]}),j.desglose_descuentos&&j.desglose_descuentos.descuento_aplicado>0&&(0,i.jsxs)(i.Fragment,{children:[j.desglose_descuentos.subtotal_elegible>0&&(0,i.jsxs)("div",{className:"flex justify-between text-xs text-gray-600",children:[(0,i.jsx)("span",{children:"Subtotal c/descuento:"}),(0,i.jsx)("span",{children:I(j.desglose_descuentos.subtotal_elegible)})]}),j.desglose_descuentos.subtotal_exento>0&&(0,i.jsxs)("div",{className:"flex justify-between text-xs text-gray-600",children:[(0,i.jsx)("span",{children:"Subtotal sin descuento:"}),(0,i.jsx)("span",{children:I(j.desglose_descuentos.subtotal_exento)})]}),(0,i.jsxs)("div",{className:"flex justify-between text-green-600 font-bold",children:[(0,i.jsxs)("span",{children:["\ud83c\udf89 DESCUENTO ",Math.round(j.desglose_descuentos.porcentaje_descuento),"% (",(null===(d=j.paymentMethod)||void 0===d?void 0:d.toUpperCase())||(null===(c=j.metodo_pago)||void 0===c?void 0:c.toUpperCase())||"EFECTIVO","):"]}),(0,i.jsxs)("span",{children:["-",I(j.desglose_descuentos.descuento_aplicado)]})]})]}),(!j.desglose_descuentos||!j.desglose_descuentos.descuento_aplicado)&&(0,i.jsxs)(i.Fragment,{children:[j.discount>0&&(0,i.jsxs)("div",{className:"flex justify-between text-green-600 font-bold",children:[(0,i.jsxs)("span",{children:["\ud83c\udf89 DESCUENTO (",Math.round(j.discount/j.subtotal*100),"%) (",(null===(m=j.paymentMethod)||void 0===m?void 0:m.toUpperCase())||"EFECTIVO","):"]}),(0,i.jsxs)("span",{children:["-",I(j.discount)]})]}),!j.discount&&P.descuento>0&&(0,i.jsxs)("div",{className:"flex justify-between text-green-600 font-bold",children:[(0,i.jsxs)("span",{children:["\ud83c\udf89 DESCUENTO (",Math.round(P.descuento/P.subtotal*100),"%):"]}),(0,i.jsxs)("span",{children:["-",I(P.descuento)]})]})]}),(0,i.jsxs)("div",{className:"flex justify-between font-bold",children:[(0,i.jsx)("span",{children:"TOTAL NETO:"}),(0,i.jsx)("span",{children:I(P.totalNeto)})]}),(0,i.jsxs)("div",{className:"border-t border-gray-300 pt-1 mt-1",children:[(0,i.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,i.jsx)("span",{children:"IVA 21% incluido:"}),(0,i.jsx)("span",{children:T(P.iva)})]}),(0,i.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,i.jsx)("span",{children:"Otros impuestos nac. indirectos:"}),(0,i.jsx)("span",{children:T(P.otrosImpuestos)})]})]}),(0,i.jsx)("div",{className:"border-t border-black pt-1 mt-1",children:(0,i.jsxs)("div",{className:"flex justify-between font-bold text-sm",children:[(0,i.jsx)("span",{children:"TOTAL A PAGAR:"}),(0,i.jsx)("span",{children:I(P.totalAPagar)})]})})]}),(0,i.jsx)("div",{className:"border-t border-dashed border-black my-2"}),(0,i.jsxs)("div",{className:"text-xs space-y-1",children:[(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{children:"FORMA DE PAGO:"}),(0,i.jsx)("span",{className:"font-bold",children:(()=>{const e=j.paymentMethod||j.metodo_pago;return{efectivo:"EFECTIVO",tarjeta:"TARJETA",transferencia:"TRANSFERENCIA",mercadopago:"MERCADO PAGO",qr:"QR"}[e]||(null===e||void 0===e?void 0:e.toUpperCase())||"EFECTIVO"})()})]}),(0,i.jsxs)("div",{className:"flex justify-between",children:[(0,i.jsx)("span",{children:"RECIBIDO:"}),(0,i.jsx)("span",{children:I(j.cashReceived||j.amountPaid||P.totalAPagar)})]}),(j.changeDue||j.change)>0&&(0,i.jsxs)("div",{className:"flex justify-between font-bold",children:[(0,i.jsx)("span",{children:"CAMBIO:"}),(0,i.jsx)("span",{children:I(j.changeDue||j.change)})]})]}),(0,i.jsx)("div",{className:"border-t border-dashed border-black my-2"}),E.datos_fiscales&&["PROCESSING","QUEUE_ERROR","SYSTEM_ERROR"].includes(E.datos_fiscales.estado_fiscal)&&(0,i.jsx)(l,{venta:E,onStatusUpdate:e=>{"completed"===e.status&&e.datos_fiscales&&C({...E,datos_fiscales:{...e.datos_fiscales,estado_fiscal:"AUTORIZADO"}})}}),S()&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:"text-center text-xs font-bold mb-2 bg-green-50 p-2 border border-green-200",children:"\u2705 COMPROBANTE AUTORIZADO POR AFIP"}),(0,i.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"12px",margin:"8px 0",padding:"6px 0"},children:[(null===(x=w())||void 0===x?void 0:x.qr_url)&&(0,i.jsx)("div",{style:{flexShrink:0},children:(0,i.jsx)("img",{src:null===(u=w())||void 0===u?void 0:u.qr_url,alt:"QR AFIP",style:{width:"60px",height:"60px",display:"block"}})}),(0,i.jsxs)("div",{style:{flex:1,fontSize:"9px",lineHeight:"1.3",color:"#000000"},children:[(0,i.jsxs)("div",{style:{marginBottom:"2px"},children:[(0,i.jsx)("strong",{children:"CAE:"})," ",(null===(p=w())||void 0===p?void 0:p.cae)||"Pendiente"]}),(0,i.jsxs)("div",{style:{marginBottom:"2px"},children:[(0,i.jsx)("strong",{children:"Comprobante:"})," ",(null===(h=w())||void 0===h?void 0:h.numero_comprobante_fiscal)||"N/A"]}),(0,i.jsxs)("div",{style:{marginBottom:"2px"},children:[(0,i.jsx)("strong",{children:"Tipo:"})," ",(null===(b=w())||void 0===b?void 0:b.tipo_comprobante)||"FACTURA"]}),(0,i.jsxs)("div",{style:{marginBottom:"2px"},children:[(0,i.jsx)("strong",{children:"P. Venta:"})," ",(null===(v=w())||void 0===v?void 0:v.punto_venta)||"0001"]}),(null===(f=w())||void 0===f?void 0:f.fecha_vencimiento_cae)&&(0,i.jsxs)("div",{children:[(0,i.jsx)("strong",{children:"Venc. CAE:"})," ",null===(g=w())||void 0===g?void 0:g.fecha_vencimiento_cae]})]})]}),(0,i.jsx)("div",{className:"border-t border-dashed border-black my-2"})]}),(0,i.jsxs)("div",{className:"text-center text-xs font-bold mb-2",children:["* R\xe9gimen de Transparencia Fiscal al",(0,i.jsx)("br",{}),"Consumidor \u2013 Ley 27.743 *"]}),(0,i.jsx)("div",{className:"border-t border-dashed border-black my-2"}),(0,i.jsxs)("div",{className:"text-center text-xs space-y-1",children:[(0,i.jsx)("div",{className:"font-bold",children:"\xa1GRACIAS POR SU COMPRA!"}),(0,i.jsx)("div",{children:"Conserve este comprobante"}),S()&&(0,i.jsx)("div",{className:"text-green-600 font-bold",children:"COMPROBANTE FISCAL V\xc1LIDO"}),(0,i.jsx)("div",{className:"text-gray-600 mt-2",children:"Sistema: Tayrona POS v1.0"})]})]}),(0,i.jsxs)("div",{className:"p-4 border-t bg-gray-50 flex gap-3 no-print",children:[(0,i.jsxs)("button",{onClick:()=>{const e=window.open("","_blank","width=300,height=600");e.document.write(`\n            <html>\n                <head>\n                    <title>Ticket - ${k()}</title>\n                    \n            <style>\n                @page {\n                    size: 58mm auto;\n                    margin: 2mm;\n                }\n                body { \n                    font-family: 'Courier New', monospace; \n                    font-size: 9px;\n                    line-height: 1.1;\n                    margin: 0;\n                    padding: 1mm;\n                    width: 54mm;\n                }\n                .center { text-align: center; }\n                .left { text-align: left; }\n                .right { text-align: right; }\n                .bold { font-weight: bold; }\n                .separator { \n                    border-top: 1px dashed #000; \n                    margin: 2mm 0; \n                }\n                .no-wrap { white-space: nowrap; }\n                .line { \n                    display: flex; \n                    justify-content: space-between; \n                }\n                .product-line {\n                    display: block;\n                    margin: 1px 0;\n                }\n                /* Estilos para secci\xf3n fiscal */\n                .fiscal-section {\n                    text-align: center;\n                    margin: 2mm 0;\n                }\n                .fiscal-section img {\n                    max-width: 20mm;\n                    max-height: 20mm;\n                    margin: 1mm auto;\n                    display: block;\n                }\n                .qr-label {\n                    font-size: 7px;\n                    font-weight: bold;\n                    margin-bottom: 1mm;\n                }\n                .cae-info {\n                    font-size: 8px;\n                    font-family: monospace;\n                    margin: 1mm 0;\n                }\n            </style>\n        \n                </head>\n                <body>\n                    ${R.current.innerHTML}\n                    <script>\n                        window.onload = function() { \n                            window.print(); \n                            window.close(); \n                        }\n                    <\/script>\n                </body>\n            </html>\n        `),e.document.close()},className:"flex-1 bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 flex items-center justify-center gap-2",children:[(0,i.jsx)(n,{size:16}),"Imprimir"]}),(0,i.jsxs)("button",{onClick:_,className:"flex-1 bg-gray-500 text-white py-2 px-4 rounded-lg hover:bg-gray-600 flex items-center justify-center gap-2",children:[(0,i.jsx)(r.A,{size:16}),"Cerrar"]})]})]})})}}}]);